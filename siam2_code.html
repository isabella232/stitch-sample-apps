<html>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
  <script src="https://s3.amazonaws.com/stitch-sdks/js/library/v2/stable/stitch.min.js"></script>
  <script>
    const client = new stitch.StitchClient('stitchdocs-jdtdl');
    const db = client.service('mongodb', 'mongodb-atlas').db('HR');

    client.login().then(() =>
      displayEmployees()
    ).catch(err => {
      console.error(err)
    });

  function displayEmployees() {
//Insert a new employee
    db.collection('employees').insertOne(
      {
        'name' : {'first' : 'Robert', 'last' : 'Zimmerman'}, 
        'role' : 'Songwriter', 
        'level' : 'Senior',
        'email' : 'bobdylan@msc.co',
        'salary' : (1000000 * Math.random()).toFixed(0)
    }).then(()=>
//Filter the find to return only employees with the same last name
    db.collection('employees').find({'name.last' : 'Zimmerman'}).execute().then(docs => {
      html = docs.map(e => '<tr><td>' + e.name.last + ', ' + e.name.first + '</td>' +
        '<td>' + e.email + '</td><td>' + e.role + ' - ' + e.level + '</td><td>$' + 
        e.salary + '</td></tr>').join('');
      document.getElementById('employees').innerHTML = html;
    }));
  }
  </script>
  <body>
    <table class='table'>
      <thead><tr><th>Name</th><th>Email</th><th>Title</th><th>Salary</th></tr></thead>
      <tbody id='employees'></tbody>
    </table>
  </body>
</html>